# Status

## Current Objective

Completing Phase 2: Architectural Consolidation, focusing on error unification and explicit schema management.

## Where To Resume

- Branch: `refactor/proto-first-completion`

## Last Verified

- `just validate` (fmt + check + clippy + test)

## How To Verify (Target)

- `just validate`

## What Changed Last

- **Standardized Workspace Dependencies**: Consolidated redundant dependencies in the workspace `Cargo.toml`. Updated `sysinfo` to 0.35 and moved to the `directories` crate for cross-platform path resolution.
- **Structured Logging**: Replaced `println!` calls in the collector and server with `tracing` macros.
- **gRPC Health Check**: Integrated `tonic-health` and registered a standard health check service in the server.
- **Version Reporting**: Added semantic versioning to `ServerState` reporting.
- **Cleaned Clippy Lints**: Resolved a large volume of Clippy warnings and errors to enable a "green" quality gate.
- **Unified Modality Registry**: `DataModality` is no longer generated by directory scanning. `lifelog_types` now re-exports `lifelog_proto::DataModality`, making the Proto the single source of truth.

## What's Next

- **Error Type Consolidation**: Define a master `LifelogError` enum in `common/lifelog-types` and migrate libraries to use it.
- **Explicit Database Schema**: Transition from on-the-fly `ensure_table` calls to a centralized schema registry with migration scripts.
- **Connection Model Refactor**: Implement the collector-initiated bidirectional gRPC stream for the Control Plane.
- **Justfile Refinement**: Add documentation to all recipes for better developer experience.
- Wire up real SurrealDB metadata persistence in `SurrealIngestBackend` (parse chunk data and insert actual records).
- Implement `IT-100` (Blob Separation) and `IT-110` (OCR Transform).

## Blockers

- None.
